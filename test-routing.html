<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MiniVue Routing Test</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      margin: 0;
      padding: 20px;
      background: #f5f5f5;
    }
    #app {
      max-width: 600px;
      margin: 0 auto;
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    .debug {
      position: fixed;
      top: 10px;
      right: 10px;
      background: #333;
      color: white;
      padding: 10px;
      border-radius: 4px;
      font-size: 12px;
      max-width: 300px;
    }
  </style>
</head>
<body>
  <div id="app"></div>
  <div class="debug" id="debug">
    <div>Debug Info:</div>
    <div id="debug-path">Path: /</div>
    <div id="debug-renders">Renders: 0</div>
    <div id="debug-errors">Errors: 0</div>
  </div>

  <script type="module">
    // Import our framework
    import { 
      createApp, 
      createRouter,
      Text, 
      Button, 
      VStack, 
      HStack, 
      TextField, 
      Link 
    } from './src/miniVue.ts';

    // Debug tracking
    let renderCount = 0;
    let errorCount = 0;

    function updateDebug() {
      document.getElementById('debug-path').textContent = `Path: ${window.location.pathname}`;
      document.getElementById('debug-renders').textContent = `Renders: ${renderCount}`;
      document.getElementById('debug-errors').textContent = `Errors: ${errorCount}`;
    }

    // Simple test pages
    const HomePage = (state) => {
      renderCount++;
      updateDebug();
      return VStack(
        Text('ðŸ  Home Page'),
        Text(`Counter: ${state.count}`),
        Button('Increment', () => {
          console.log('Button clicked, incrementing count');
          state.count++;
        }),
        TextField(state.text, (value) => {
          console.log('TextField changed:', value);
          state.text = value;
        }, 'Type here...'),
        HStack(
          Link('About', '/about'),
          Link('Contact', '/contact')
        )
      );
    };

    const AboutPage = (state) => {
      renderCount++;
      updateDebug();
      return VStack(
        Text('â„¹ï¸ About Page'),
        Text('This is the about page.'),
        Text(`Your text from home: "${state.text}"`),
        HStack(
          Link('Home', '/'),
          Link('Contact', '/contact')
        )
      );
    };

    const ContactPage = (state) => {
      renderCount++;
      updateDebug();
      return VStack(
        Text('ðŸ“§ Contact Page'),
        TextField(state.email, (value) => state.email = value, 'Email...'),
        TextField(state.message, (value) => state.message = value, 'Message...'),
        Button('Send', () => {
          alert(`Email: ${state.email}, Message: ${state.message}`);
        }),
        HStack(
          Link('Home', '/'),
          Link('About', '/about')
        )
      );
    };

    // Create router
    const router = createRouter([
      { path: '/', component: HomePage },
      { path: '/about', component: AboutPage },
      { path: '/contact', component: ContactPage },
      { path: '*', component: () => VStack(Text('404 - Not Found'), Link('Home', '/')) }
    ]);

    // Create and mount app
    try {
      const app = createApp({
        data: () => ({
          count: 0,
          text: '',
          email: '',
          message: ''
        }),
        router
      });

      app.mount('#app');
      console.log('App mounted successfully');
      updateDebug();

      // Test navigation programmatically
      window.testNavigation = () => {
        console.log('Testing navigation...');
        router.navigate('/about');
        setTimeout(() => router.navigate('/contact'), 1000);
        setTimeout(() => router.navigate('/'), 2000);
      };

    } catch (error) {
      errorCount++;
      console.error('App mount error:', error);
      document.getElementById('app').innerHTML = `<div style="color:red;">Error: ${error.message}</div>`;
      updateDebug();
    }
  </script>
</body>
</html> 